/*!
Off Canvas Infinity Push, a infinity push mobile navigation jQuery plugin.

Version 1.0.2
Full source at https://github.com/marc-andrew/off-canvas-infinity-push
Copyright (c) 2014 Marc Andrew http://marcandrew.net/off-canvas-infinity-push

MIT License (http://www.opensource.org/licenses/mit-license.html)
*/

!function(a){a.fn.infinitypush=function(b){var c={offcanvas:!0,offcanvasspeed:400,offcanvasleft:!0,openingspeed:400,closingspeed:400,spacing:90,pushdirectionleft:!0,autoScroll:!0,scrollSpeed:300,destroy:!1},d=this,e=a.extend({},c,b);return this.each(function(){function b(){a("."+o).unbind(),a("."+s).unbind(),a("body").removeClass(v),a("."+k).next().removeAttr("style"),a("."+k).find("."+x).removeClass(x).find("."+y).removeClass(y).find("."+z).remove(),a("."+k).find("ul").removeAttr("style"),d.prependTo(j).removeClass(s+" "+w),a("."+k).remove(),a(this).removeClass(s),d.stop().removeAttr("style")}function c(){var b=a("."+o),c="off",d="on",e="Reveal Navigation",f="Close Navigation",g="false",h="true";b.attr("data-state",b.attr("data-state")===c?d:c),b.attr("aria-label",b.attr("aria-label")===e?f:e),b.attr("aria-expanded",b.attr("aria-expanded")===g?h:g)}function f(){a("."+o).on("click",function(){a("body").hasClass(v)?g():(h(),c())})}function g(){e.offcanvasleft===!0?a("."+k).stop().animate({left:"-"+A+"px"},e.offcanvasspeed):a("."+k).stop().animate({right:"-"+A+"px"},e.offcanvasspeed),a("."+s).stop().animate({opacity:"hide"},e.offcanvasspeed),e.offcanvasleft===!0?a("."+k).next().stop().animate({left:0},e.offcanvasspeed):a("."+k).next().stop().animate({right:0},e.offcanvasspeed),a("body").removeClass(v),c()}function h(){a("body").addClass(v),e.offcanvasleft===!0?a("."+k).stop().animate({left:0},e.offcanvasspeed):a("."+k).stop().animate({right:0},e.offcanvasspeed),a("."+s).stop().animate({opacity:"show"},e.offcanvasspeed),e.offcanvasleft===!0?a("."+k).next().stop().animate({left:A+"px"},e.offcanvasspeed):a("."+k).next().stop().animate({right:A+"px"},e.offcanvasspeed),i()}function i(){a("."+v).on("mousedown touchstart",function(b){a("."+v).length&&(a("."+k).is(b.target)||0!==a("."+k).has(b.target).length||g())})}var j=a(this).data("oldposition")||a("body"),k="ma-infinitypush-wrapper",l='<div class="'+k+'"></div>',m="primary-navigation",n="ma-infinitypush-active-button",o="ma-infinitypush-button",p='<button type="button" aria-expanded="false" aria-controls="'+m+'" aria-label="Reveal Navigation" class="'+o+'"></button>',q="ma-infinitypush-button-left",r="ma-infinitypush-button-right",s="ma-infinitypush",t="ma-infinitypush-left",u="ma-infinitypush-right",v="ma-infinitypush-open",w="ma-infinitypush-sub-open",x="ma-infinitypush-inactive",y="ma-infinitypush-active-item",z="ma-infinitypush-close-subnav";if(e.destroy)return void(a(this).hasClass(s)&&b());if(!a(this).hasClass(s)){a(this).data("oldposition",a(this).parent()),a(this).parent().is("body")||a("body").prepend(a(this)),a(this).before(l).addClass(s).appendTo("."+k);var A=a("."+k).width();e.offcanvas===!0&&(a(this).before(p),e.offcanvasleft===!0?a("."+k).css({left:"-"+A+"px"}).addClass(q):a("."+k).css({right:"-"+A+"px"}).addClass(r),a("."+k).addClass(e.pushdirectionleft===!0?t:u),a("."+k).addClass(n),f()),a("."+s).on("click","a",function(){var b=a(d).width(),c=a(this).parents(d).children("ul"),f=a(this).closest("ul"),g=a(this).parent().find("ul").first(),h='<a href="#" class="'+z+'"></a>';if(c.hasClass(x)&&c.siblings().not(x)){if(f.hasClass(x))return e.pushdirectionleft===!0?f.find("ul").animate({right:-(b-e.spacing),opacity:"hide"},e.closingspeed):f.find("ul").animate({left:-(b-e.spacing),opacity:"hide"},e.closingspeed),a(this).parent().parent().parent().hasClass(w)?a(d).removeClass(w):f.animate({width:b-e.spacing},e.closingspeed),f.removeClass(x),f.find("ul").removeClass(x),f.siblings().removeClass(x),f.find("li").removeClass(y),f.find("."+z).animate({opacity:"hide"},e.closingspeed,function(){a(this).remove()}),!1;if(g.length>0&&!g.is(":visible")){var i=f.scrollTop();return a(this).parent().addClass(y),f.addClass(x),e.autoScroll===!0&&i>=1&&f.animate({scrollTop:0},e.scrollSpeed),e.autoScroll===!0?i>=1?a(h).delay(e.scrollSpeed).insertAfter(a(this)).css("display","none").animate({opacity:"show"},e.openingspeed):a(h).insertAfter(a(this)).css("display","none").animate({opacity:"show"},e.openingspeed):i>=1?a(h).insertAfter(a(this)).css({display:"none",top:i}).animate({opacity:"show"},e.openingspeed):a(h).insertAfter(a(this)).css({display:"none",top:0}).animate({opacity:"show"},e.openingspeed),e.pushdirectionleft===!0?e.autoScroll===!0?i>=1?g.delay(e.scrollSpeed).css({right:-(b-e.spacing)}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):g.css({right:-(b-e.spacing)}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):i>=1?g.css({right:-(b-e.spacing),top:i}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):g.css({right:-(b-e.spacing),top:0}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):e.autoScroll===!0?g.delay(e.scrollSpeed).css({left:-(b-e.spacing)}).animate({left:0,opacity:"show",width:b-e.spacing},e.openingspeed):i>=1?g.css({left:-(b-e.spacing),top:i}).animate({left:0,opacity:"show",width:b-e.spacing},e.openingspeed):g.css({left:-(b-e.spacing),top:0}).animate({left:0,opacity:"show",width:b-e.spacing},e.openingspeed),f.animate({width:b},e.openingspeed),!1}}else if(g.length>0&&!g.is(":visible")){var j=a("."+s).scrollTop();return a(this).parent().addClass(y),f.addClass(x),f.siblings().addClass(x),a(d).find("ul").is(":visible")&&a(d).addClass(w),e.autoScroll===!0&&j>=1&&a("."+s).animate({scrollTop:0},e.scrollSpeed),e.autoScroll===!0?j>=1?a(h).delay(e.scrollSpeed).insertAfter(a(this)).css("display","none").animate({opacity:"show"},e.openingspeed):a(h).insertAfter(a(this)).css("display","none").animate({opacity:"show"},e.openingspeed):j>=1?a(h).insertAfter(a(this)).css({display:"none",top:j}).animate({opacity:"show"},e.openingspeed):a(h).insertAfter(a(this)).css({display:"none",top:0}).animate({opacity:"show"},e.openingspeed),e.pushdirectionleft===!0?e.autoScroll===!0?j>=1?g.delay(e.scrollSpeed).css({right:-(b-e.spacing)}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):g.css({right:-(b-e.spacing)}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):j>=1?g.css({right:-(b-e.spacing),top:j}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):g.css({right:-(b-e.spacing),top:0}).animate({right:0,opacity:"show",width:b-e.spacing},e.openingspeed):e.autoScroll===!0?g.delay(e.scrollSpeed).css({left:-(b-e.spacing)}).animate({left:0,opacity:"show",width:b-e.spacing},e.openingspeed):j>=1?g.css({left:-(b-e.spacing),top:j}).animate({left:0,opacity:"show",width:b-e.spacing},e.openingspeed):g.css({left:-(b-e.spacing),top:0}).animate({left:0,opacity:"show",width:b-e.spacing},e.openingspeed),!1}})}})}}(jQuery);